{{
    config (
      engine='MergeTree()',
      order_by='id'
    )
}}

select type
,id
,thumbnail
,image
,primary
,alternate
,description
,yearpublished
,minplayers
,maxplayers
,suggested_num_players
,suggested_playerage
,suggested_language_dependence
,playingtime
,minplaytime
,maxplaytime
,minage
,boardgamecategory
,boardgamemechanic
,boardgamefamily
,boardgameexpansion
,boardgameimplementation
,boardgamedesigner
,boardgameartist
,boardgamepublisher
,usersrated
,average
,bayesaverage
,toUInt32OrNull("Board Game Rank") "Board Game Rank"
,toUInt32OrNull("Strategy Game Rank") "Strategy Game Rank"
,toUInt32OrNull("Family Game Rank") "Family Game Rank"
,stddev
,median
,owned
,trading
,wanting
,wishing
,numcomments
,numweights
,averageweight
,boardgameintegration
,boardgamecompilation
,toUInt32OrNull("Party Game Rank") "Party Game Rank"
,toUInt32OrNull("Abstract Game Rank") "Abstract Game Rank"
,toUInt32OrNull("Thematic Rank") "Thematic Rank"
,toUInt32OrNull("War Game Rank") "War Game Rank"
,toUInt32OrNull("Customizable Rank") "Customizable Rank"
,toUInt32OrNull("Children's Game Rank") "Children's Game Rank"
,toUInt32OrNull("RPG Item Rank") "RPG Item Rank"
,toUInt32OrNull("Accessory Rank") "Accessory Rank"
,toUInt32OrNull("Video Game Rank") "Video Game Rank"
,toUInt32OrNull("Amiga Rank") "Amiga Rank"
,toUInt32OrNull("Commodore 64 Rank") "Commodore 64 Rank"
,toUInt32OrNull("Arcade Rank") "Arcade Rank"
,toUInt32OrNull("Atari ST Rank") "Atari ST Rank"
from {{ source('dezdb','stg_games_detailed') }}

{% if var('is_test_run', default=false) %}

  limit 100

{% endif %}